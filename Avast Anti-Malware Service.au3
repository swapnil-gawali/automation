#include <AutoItConstants.au3>

while 1

;~ WinSetOnTop("[CLASS:SunAwtFrame]", "", 0)
;~ WinActivate("[CLASS:MozillaWindowClass]")
;~ WinSetOnTop("[CLASS:MozillaWindowClass]", "", 1)

;~ Run ("firefox.exe")
;~ WinSetOnTop("[CLASS:SunAwtFrame]", "", 0)
;~ WinActivate("[CLASS:MozillaCompositorWindowClass]")
;~ WinSetOnTop("[CLASS:MozillaCompositorWindowClass]", "", 1)
;~ Sleep(5000)


;~ Run(@ProgramFilesDir & "\Mozilla Firefox\firefox.exe", "", @SW_MINIMIZE)
;~ Opt("WinTitleMatchMode", 2)
;~ WinWait("Mozilla Firefox")
;~ WinSetState("Mozilla Firefox", "", @SW_MINIMIZE)

For $a1 = 1 TO Random(1, 10, 1)
   _SimulateAndroidStudio()
Next

Send("{ALT down}{TAB}{ALT up}")

Sleep(5000)

_SimulateChrome()

Sleep(5000)

WEnd

Func _SimulateAndroidStudio()
   WinSetOnTop("[CLASS:Chrome_WidgetWin_1]", "", 0)
   WinActivate("[CLASS:SunAwtFrame]")
   WinSetOnTop("[CLASS:SunAwtFrame]", "", 1)
   Sleep(5000)

   ; Right click and drag mouse
   _DragMouse()

   ; Mouse movement
   _MoveMouse()

   ; Scroll mouse to down
   _MouseWheelDown()

   ; Navigate to android studio next tab
   Send("{ALT down}{RIGHT}{ALT up}")
   Sleep(5000)

   ; Send random right, left, up, down arrow keystrokes
   _SendRandomKeyStrokes()

   ; If random number is 1 then only right click will simulate
   _SendRandomRightClick()

   _SendRandomLeftClick()

   ; Scroll Mouse to Up
   _MouseWheelUp()

   _SendRandomLeftClick()
   Sleep(5000)

   _SendRandomDoubleClick()

   _MoveMouse()

   Sleep(Random(10000, 20000, 1)) ;next loop will start in  10 to 30 seconds
   WinSetOnTop("[CLASS:SunAwtFrame]", "", 0)
EndFunc

Func _SimulateChrome()
   ;Simulate Firefox
   WinSetOnTop("[CLASS:SunAwtFrame]", "", 0)
   WinActivate("[CLASS:Chrome_WidgetWin_1]")
   WinSetOnTop("[CLASS:Chrome_WidgetWin_1]", "", 1)
   Sleep(10000)

   _MouseWheelDown()
   Sleep(10000)

   _MouseWheelDown()
   Sleep(10000)

   _DragMouse()
   Sleep(5000)

   _MouseWheelUp()
   Sleep(10000)

   _MouseWheelUp()
   Sleep(10000)

   Send("^{TAB}")

EndFunc

Func _MoveMouse()
   MouseMove(MouseGetPos()[0] + 200, MouseGetPos()[1])
   Sleep(250)

   MouseMove(MouseGetPos()[0], MouseGetPos()[1] + 200)
   Sleep(250)

   MouseMove(MouseGetPos()[0] - 200, MouseGetPos()[1])
   Sleep(250)

   MouseMove(MouseGetPos()[0], MouseGetPos()[1] - 200)
   Sleep(5000)
EndFunc

Func _SendRandomKeyStrokes()
   For $a1 = 1 TO Random(1, 7, 1)
	  Send("{ALT}")
	  Sleep(1000)

	  Send("{HOME}")
	  Sleep(1000)

	  Send("{ALT}")
	  Sleep(1000)

	  Send("{END}")
	  Sleep(1000)
   Next
EndFunc

Func _SendRandomDoubleClick()
   If Random(0, 1, 1) = 1 Then
	  MouseClick($MOUSE_CLICK_LEFT)
	  Sleep(100)
	  MouseClick($MOUSE_CLICK_LEFT)
	  Sleep(5000)
   EndIf
EndFunc

Func _SendRandomLeftClick()
   For $a1 = 1 TO Random(2, 10, 1)
	  MouseClick($MOUSE_CLICK_LEFT)
	  Sleep(500)
   Next
   Sleep(5000)
EndFunc

Func _SendRandomRightClick()
   If Random(0, 1, 1) = 1 Then
	  MouseClick($MOUSE_CLICK_RIGHT)
	  Sleep(1000)
	  Send("{ESC}", 0)
	  Sleep(5000)
   EndIf
EndFunc

Func _MouseWheelDown()
   MouseWheel($MOUSE_WHEEL_DOWN, Random(1, 15, 1))
   Sleep(1000)

   MouseClick($MOUSE_CLICK_LEFT)
   Sleep(5000)
EndFunc

Func _MouseWheelUp()
   MouseWheel($MOUSE_WHEEL_UP, Random(1, 15, 1))
   Sleep(1000)

   MouseClick($MOUSE_CLICK_LEFT)
   Sleep(5000)
EndFunc

Func _DragMouse()
   MouseClickDrag($MOUSE_CLICK_LEFT,MouseGetPos()[0], MouseGetPos()[1], MouseGetPos()[0] + 20, MouseGetPos()[1] + 20)
   Sleep(2000)
EndFunc